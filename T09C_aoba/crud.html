<!DOCTYPE html>
<html lang="en">
 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="crudStyle.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chocolate+Classical+Sans&family=New+Rocker&display=swap"
        rel="stylesheet">
</head>
 
<body>
    <input type="checkbox" id="menu-toggle" class="menu-toggle-checkbox">
    <label for="menu-toggle" class="menu-toggle-label">☰</label>
    <aside>
        <div class="logo">
            <h2>Menu</h2>
            <img src="logo1.png" alt="Logo AOBA">
        </div>
        <nav>
            <div Class="Dash">
                <a href="http://127.0.0.1:5500/Dashboard.html">
                    <img src="grafico1.png" alt="grafico">Dashboard
                </a>
            </div>
            <div Class="Relatorios">
                <a href="#">
                    <img src="caderno1.png" alt="Relatorios">Relatórios
                </a>
            </div>
            <div Class="Usuarios">
                <a href="#">
                    <img src="perfil-de-usuario1.png" alt="user">Usuários
                </a>
            </div>
            <div Class="Config">
                <a href="#">
                    <img src="engrenagem1.png" alt="engrenagem">Configurações
                </a>
            </div>
        </nav>
    </aside>
    <main>
        <header>
            <h1>Cadastros</h1>
 
        </header>
        <!-- seleção de qual tipo de registo deseja e botão para direcionar ao cadastro-->
        <section class="cards">
            <div class="card">
 
                <h3>Selecione a área de que deseja cadastrar</h3>
 
                <div class="inicioCrud">
                    <label for="tipo"></label>
                    <select id="tipo">
                        <option value="exame">Exame</option>
                        <option value="consulta">Consulta</option>
                    </select>
                    <button id="myBtn">+</button>
                </div>
 
            </div>
        </section>
        <section class="chart">
 
            <!--tabela de registro-->
            <div class="chart-grid">
 
                <table id="registro"></table>
 
 
            </div>
        </section>
        <footer>
            © 2025 - AOBA
        </footer>
    </main>
 
 
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <form id="formulario">
                <div id="formCampos"></div>
                <button id="btnCadastrar" type="submit">Cadastrar</button>
            </form>
        </div>
    </div>
 
    <script>
        const modal = document.getElementById("myModal");
        const btn = document.getElementById("myBtn");
        const span = document.getElementsByClassName("close")[0];
        const formCampos = document.getElementById("formCampos");
        const registro = document.getElementById("registro");
        const form = document.getElementById("formulario");
 
        const registros = [];
        let modoEdicao = false;
        let registroEmEdicao = null;
 
        btn.onclick = function () {
            abrirModal();
        };
 
        span.onclick = () => modal.style.display = "none";
        window.onclick = e => { if (e.target == modal) modal.style.display = "none"; };
 
        function abrirModal(registro = null) {
            const tipo = document.getElementById("tipo").value;
            formCampos.innerHTML = "";
            modoEdicao = registro !== null;
            registroEmEdicao = registro;
 
            if (tipo === "exame") {
                formCampos.innerHTML = `
              <h3 id="CE">Cadastro de Exame<h3>
 
              <div class="form-group">
                <label for="nome">Nome do exame</label>
                <input type="text" placeholder="Nome do exame" id="nome" value="${registro?.nome || ''}" required />
              </div>
 
              <div class="form-group">
                <label for="descricao">Descrição</label>
                <textarea id="descricao" placeholder="Descrição" rows="3">${registro?.descricao || ''}</textarea>
              </div>
 
            `;
            } else {
                formCampos.innerHTML = `
 
              <h3 id="CC">Cadastro de Consulta<h3>
 
              <div class="form-group">
                <label for="paciente">Nome do paciente</label>
                <input type="text" placeholder="Nome do paciente" id="paciente" value="${registro?.paciente || ''}" required />
              </div>
 
              <div class="form-group">
                <label for="medico">Nome do médico</label>
                <input type="text" placeholder="Nome do médico" id="medico" value="${registro?.medico || ''}" required />
              </div>
 
              <div class="form-group">
                <label for="data">Data da consulta</label>
                <input type="date" placeholder="Data da consulta" id="data" value="${registro?.data || ''}" required />
              </div>
 
              <div class="form-group">
                <label for="observacao">Observação</label>
                <textarea id="observacao" placeholder="Observação" rows="3">${registro?.observacao || ''}</textarea>
              </div>
 
            `;
            }
 
            modal.style.display = "block";
        }
 
        form.onsubmit = function (e) {
            e.preventDefault();
            const tipo = document.getElementById("tipo").value;
 
            if (tipo === "exame") {
                const nome = document.getElementById("nome").value;
                const descricao = document.getElementById("descricao").value;
 
                const novoRegistro = {
                    id: modoEdicao ? registroEmEdicao.id : Date.now(),
                    tipo,
                    nome,
                    descricao
                };
 
                salvarRegistro(novoRegistro);
            } else {
                const paciente = document.getElementById("paciente").value;
                const medico = document.getElementById("medico").value;
                const data = document.getElementById("data").value;
                const observacao = document.getElementById("observacao").value;
 
                const novoRegistro = {
                    id: modoEdicao ? registroEmEdicao.id : Date.now(),
                    tipo,
                    paciente,
                    medico,
                    data,
                    observacao
                };
 
                salvarRegistro(novoRegistro);
            }
 
            form.reset();
            modal.style.display = "none";
        };
 
        function salvarRegistro(registro) {
            if (modoEdicao) {
                const index = registros.findIndex(r => r.id === registro.id);
                registros[index] = registro;
            } else {
                registros.push(registro);
            }
            atualizarTabela();
        }
 
        function atualizarTabela() {
            const tipoAtual = document.getElementById("tipo").value;
            const filtrados = registros.filter(r => r.tipo === tipoAtual);
 
            let html = `
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  ${tipoAtual === 'exame'
                    ? '<th>Nome</th> <th>Descrição</th>'
                    : '<th>Paciente</th> <th>Médico</th> <th>Data</th> <th>Observação</th>'}
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                ${filtrados.map(r => `
                  <tr>
                    <td>${r.id}</td>
                    ${tipoAtual === 'exame'
                            ? `<td>${r.nome}</td><td>${r.descricao}</td>`
                            : `<td>${r.paciente}</td><td>${r.medico}</td><td>${r.data}</td><td>${r.observacao}</td>`}
                    <td class="acoes">
                      <button id="editar" onclick="editarRegistro(${r.id})"><img src="editar1.png" alt="simbolo_editar" style="width:18px; height:18px;"></button>
                      <button id="deletar" onclick="deletarRegistro(${r.id})"><img src="deletar1.png" alt="simbolo_deletar" style="width:17px; height:18px;"></button>
                    </td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          `;
 
            registro.innerHTML = html;
        }
 
        function editarRegistro(id) {
            const registro = registros.find(r => r.id === id);
            abrirModal(registro);
        }
 
        function deletarRegistro(id) {
            if (confirm("Deseja realmente excluir este registro?")) {
                const index = registros.findIndex(r => r.id === id);
                registros.splice(index, 1);
                atualizarTabela();
            }
        }
 
        document.getElementById("tipo").addEventListener("change", atualizarTabela);
 
        atualizarTabela();
    </script>
</body>
 
</html>